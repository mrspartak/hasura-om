<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hasura | API | Hasura ORM</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="Fragment oriented Hasura ORM for backends with many stuff "from the box"">
    <link rel="preload" href="/assets/css/0.styles.d3e2721c.css" as="style"><link rel="preload" href="/assets/js/app.b0b3b14d.js" as="script"><link rel="preload" href="/assets/js/2.8f0b80ee.js" as="script"><link rel="preload" href="/assets/js/3.3e1d89ec.js" as="script"><link rel="preload" href="/assets/js/11.e6b53fb8.js" as="script"><link rel="prefetch" href="/assets/js/10.28e73c70.js"><link rel="prefetch" href="/assets/js/12.c1bfed8a.js"><link rel="prefetch" href="/assets/js/13.667ee254.js"><link rel="prefetch" href="/assets/js/14.12e1f4cd.js"><link rel="prefetch" href="/assets/js/15.c500bb3c.js"><link rel="prefetch" href="/assets/js/16.e41e82c7.js"><link rel="prefetch" href="/assets/js/17.c051b656.js"><link rel="prefetch" href="/assets/js/18.e922d575.js"><link rel="prefetch" href="/assets/js/19.227f4d19.js"><link rel="prefetch" href="/assets/js/4.c5e72030.js"><link rel="prefetch" href="/assets/js/5.f2fb31f5.js"><link rel="prefetch" href="/assets/js/6.6676af00.js"><link rel="prefetch" href="/assets/js/7.87be8f7d.js"><link rel="prefetch" href="/assets/js/8.99882b7b.js"><link rel="prefetch" href="/assets/js/9.fc5e3096.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d3e2721c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hasura_icon_blue.svg" alt="Hasura ORM" class="logo"> <span class="site-name can-hide">Hasura ORM</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/api/hasura.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ru/" class="nav-link">
  Русский (черновик)
</a></li></ul></div></div> <a href="https://github.com/mrspartak/hasura-om" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/api/hasura.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ru/" class="nav-link">
  Русский (черновик)
</a></li></ul></div></div> <a href="https://github.com/mrspartak/hasura-om" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" class="sidebar-link">Introduction</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/guide/create-fragment.html" class="sidebar-link">Creating fragment</a></li><li><a href="/guide/query.html" class="sidebar-link">Making queries</a></li><li><a href="/guide/mutation.html" class="sidebar-link">Making mutations</a></li><li><a href="/guide/subscribe.html" class="sidebar-link">Subscribing</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Api</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/api/hasura.html" aria-current="page" class="active sidebar-link">Hasura</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/hasura.html#instance-methods" class="sidebar-link">Instance Methods</a></li><li class="sidebar-sub-header"><a href="/api/hasura.html#usage" class="sidebar-link">Usage</a></li></ul></li><li><a href="/api/table.html" class="sidebar-link">Table</a></li><li><a href="/api/field.html" class="sidebar-link">Field</a></li><li><a href="/api/fragment.html" class="sidebar-link">Fragment</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hasura"><a href="#hasura" class="header-anchor">#</a> Hasura</h1> <p>This is a main class. All queries/mutations/subscription you will run using it's instance.</p> <h2 id="instance-methods"><a href="#instance-methods" class="header-anchor">#</a> Instance Methods</h2> <h3 id="new-hasura-parameters"><a href="#new-hasura-parameters" class="header-anchor">#</a> <code>new Hasura( parameters )</code></h3> <p>Currently ORM works only on backend and uses admin access to Hasura</p> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> <ul><li><code>{string} graphqlUrl</code> - Hasura's graphql endpoint</li> <li><code>{string} adminSecret</code> - admin secret to access endpoint</li> <li><code>{string} [queryUrl]</code> - Hasura's query API endpoint (autogenerated from graphqlUrl by default)</li> <li><code>{string} [wsUrl]</code> - Hasura's Websocket endpoint (autogenerated from graphqlUrl by default)</li> <li><code>{object} [query]</code> - Query method specific settings
<ul><li><code>{boolean} [flatOne = true]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li> <li><code>{object} [subscription]</code> - Subscribe method specific settings
<ul><li><code>{boolean} [flatOne = true]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li> <li><code>{object} [mutation]</code> - Mutate method specific settings
<ul><li><code>{boolean} [flatOne = true]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li> <li><code>{object} [gqlConnectionSettings]</code> - Hasura's graphql API endpoint settings (currenlty blank)</li> <li><code>{object} [sqlConnectionSettings]</code> - Hasura's query API endpoint settings (currenlty blank)</li> <li><code>{object} [wsConnectionSettings]</code> - Hasura's Websocket API endpoint settings
<ul><li><code>{boolean} [lazy = true]</code> - WS lazy connection. If true - connection will be established only on first subscripe method call</li> <li><code>{boolean} [reconnect = true]</code> - WS reconnect connection.</li></ul></li></ul></li></ul></li> <li><strong>Example:</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>Hasura<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'hasura-om'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> orm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hasura</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    graphqlUrl<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    adminSecret<span class="token operator">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="async-this-generatetablesfromapi"><a href="#async-this-generatetablesfromapi" class="header-anchor">#</a> <code>async this.generateTablesFromAPI()</code></h3> <ul><li><strong>Usage:</strong>
This method gets information about tables from Hasura's query API and generates the whole schema</li> <li><strong>Example:</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">generateTablesFromAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="this-createtable-parameters"><a href="#this-createtable-parameters" class="header-anchor">#</a> <code>this.createTable( parameters )</code></h3> <p>This a <a href="table"><code>Table</code></a> constructor</p> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> <ul><li><code>{string} name</code></li> <li><code>{string} [type]</code></li></ul></li></ul></li> <li><strong>Returns:</strong> <a href="table"><code>{Table}</code></a> Instance</li> <li><strong>Example:</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>orm<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'user'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="this-table-name"><a href="#this-table-name" class="header-anchor">#</a> <code>this.table( name )</code></h3> <ul><li><strong>Arguments:</strong> <ul><li><code>{string} name</code></li></ul></li> <li><strong>Returns:</strong> <a href="table"><code>{Table}</code></a> Instance</li> <li><strong>Example:</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>orm<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isPrimary<span class="token punctuation">)</span>
</code></pre></div><h3 id="async-this-query-parameters-settings"><a href="#async-this-query-parameters-settings" class="header-anchor">#</a> <code>async this.query( parameters, settings )</code></h3> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> <ul><li><code>{object} tablename*</code> - here you should put exact table <code>name</code> <ul><li><code>{object} select</code> - select query. You can skip this key and define its options if you query select only
<ul><li><code>{object} [where]</code> - where object <code>{ age :{ _gt: 18 } }</code></li> <li><code>{integer} [limit]</code> - limit</li> <li><code>{integer} [offset]</code> - offset</li> <li><code>{object} [order_by]</code> - order_by object <code>{ last_seen: 'desc' }</code></li> <li><code>{string} [distinct_on]</code> - distinct_on <code>type</code></li> <li><code>{string | array | object} [fields]</code> - you can define fields just like in <a href="fragment"><code>{Fragment}</code></a> Instance</li> <li><code>{string | Fragment} [fragment]</code> - <code>name</code> of Fragment or a <code>Fragment</code> instance</li></ul></li> <li><code>{object} aggregate</code> - aggregate query
<ul><li><code>{object} [where]</code> - where object <code>{ age :{ _gt: 18 } }</code></li> <li><code>{integer} [limit]</code> - limit</li> <li><code>{integer} [offset]</code> - offset</li> <li><code>{object} [order_by]</code> - order_by object <code>{ last_seen: 'desc' }</code></li> <li><code>{string} [distinct_on]</code> - distinct_on <code>type</code></li> <li><code>{string | array | object} [fields]</code> - you can define aggregate by yourself just like in <a href="fragment"><code>{Fragment}</code></a> Instance</li> <li><code>{object} count</code> - can leave empty if you need just count all the fields
<ul><li><code>{string} columns</code></li> <li><code>{boolean} distinct</code></li></ul></li> <li><code>{string} avg</code></li> <li><code>{string} max</code></li> <li><code>{string} min</code></li> <li><code>{string} stddev</code></li> <li><code>{string} stddev_pop</code></li> <li><code>{string} stddev_samp</code></li> <li><code>{string} sum</code></li> <li><code>{string} var_pop</code></li> <li><code>{string} var_samp</code></li> <li><code>{string} variance</code></li></ul></li></ul></li></ul></li> <li><code>{object} [settings]</code> <ul><li><code>{boolean} [flatOne]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li></ul></li> <li><strong>Returns:</strong> <ul><li><code>{array}</code> - reponse in format [err, response]
<ul><li><code>{object} error</code></li> <li><code>{object | array} response</code></li></ul></li></ul></li> <li><strong>Example</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> response<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> 
        where<span class="token operator">:</span> <span class="token punctuation">{</span> isOnline<span class="token operator">:</span> <span class="token punctuation">{</span> _eq<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'userpic'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token comment">/* 
    [
        {id: 2, name: 'Peter', userpic: 'https://....'},
        ...
    ]
*/</span>
</code></pre></div><h3 id="async-this-mutate-parameters-settings"><a href="#async-this-mutate-parameters-settings" class="header-anchor">#</a> <code>async this.mutate( parameters, settings )</code></h3> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> <ul><li><code>{object} tablename*</code> - here you should put exact table <code>name</code> <ul><li><code>{object} insert</code> - Insert mutation
<ul><li><code>{object | array} object</code> - object or array of object defining inserting row. Of course you can inserted nested rows too</li> <li><code>{string | array | object} [fields]</code> - you can define fields just like in <a href="fragment"><code>{Fragment}</code></a> Instance</li> <li><code>{string | Fragment} [fragment]</code> - <code>name</code> of Fragment or a <code>Fragment</code> instance</li></ul></li> <li><code>{object} update</code> - Update mutation
<ul><li><code>{object} where</code> - where object <code>{ age :{ _gt: 18 } }</code></li> <li><code>{object} _set</code> - set object <code>{ age : 21 }</code></li> <li><code>{object} _inc</code> - increment object <code>{ age : 2 }</code></li> <li><code>{string | array | object} [fields]</code> - you can define fields just like in <a href="fragment"><code>{Fragment}</code></a> Instance</li> <li><code>{string | Fragment} [fragment]</code> - <code>name</code> of Fragment or a <code>Fragment</code> instance</li></ul></li> <li><code>{object} delete</code> - Delete mutation
<ul><li><code>{object} where</code> - where object <code>{ age :{ _gt: 18 } }</code></li> <li><code>{string | array | object} [fields]</code> - you can define fields just like in <a href="fragment"><code>{Fragment}</code></a> Instance</li> <li><code>{string | Fragment} [fragment]</code> - <code>name</code> of Fragment or a <code>Fragment</code> instance</li></ul></li></ul></li></ul></li> <li><code>{object} [settings]</code> <ul><li><code>{boolean} [flatOne]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li></ul></li> <li><strong>Returns:</strong> <ul><li><code>{array}</code> - reponse in format [err, response]
<ul><li><code>{object} error</code></li> <li><code>{object | array} response</code></li></ul></li></ul></li> <li><strong>Example</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> response<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span>
        insert<span class="token operator">:</span> <span class="token punctuation">{</span>
            objects<span class="token operator">:</span> <span class="token punctuation">{</span>
                name<span class="token operator">:</span> <span class="token string">'Peter'</span><span class="token punctuation">,</span>
                userpic<span class="token operator">:</span> <span class="token string">'https://...'</span><span class="token punctuation">,</span>
                points<span class="token operator">:</span> <span class="token number">300</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        update<span class="token operator">:</span> <span class="token punctuation">{</span>
            where<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> _eq<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            _inc<span class="token operator">:</span> <span class="token punctuation">{</span> points<span class="token operator">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'points'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token comment">/* 
    {
        insert: [
            {id: 3, name: 'Peter', points: 300, ...allUserFields},
        ],
        update: [
            {id: 3, name: 'Peter', points: 350},
        ]
    }
*/</span>
</code></pre></div><h3 id="async-this-subscribe-parameters-callback-settings"><a href="#async-this-subscribe-parameters-callback-settings" class="header-anchor">#</a> <code>async this.subscribe( parameters, callback, settings )</code></h3> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> - just like in a <a href="#async-this-query-parameters-settings">query method</a></li> <li><code>{function} callback([err, response])</code> - function to be called on changes</li> <li><code>{object} [settings]</code> <ul><li><code>{boolean} [flatOne]</code> - Response manipulation. Please read <a href="#this-flatgqlresponse-flatsettings-settings-parameters">flatOne</a> method</li></ul></li></ul></li> <li><strong>Returns:</strong> <ul><li><code>{function} unsubscribe</code> - call this function if you want to stop subscription</li></ul></li> <li><strong>Example</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> unsubscribe <span class="token operator">=</span> orm<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token punctuation">{</span> isOnline<span class="token operator">:</span> <span class="token punctuation">{</span> _eq<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>err<span class="token punctuation">,</span> users<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="this-flatgqlresponse-flatsettings-settings-parameters"><a href="#this-flatgqlresponse-flatsettings-settings-parameters" class="header-anchor">#</a> <code>this.flatGqlResponse( { flatSettings, settings, parameters } )</code></h3> <p>This method can migrate to a different place, cause it is utitilitary</p> <ul><li><strong>Arguments:</strong> <ul><li><code>{object} parameters</code> <ul><li><code>{array} [flatSettings]</code> - an array of objects key: value - path_from: path_to <code>[ { 'user.returning': 'user.select' } ]</code></li> <li><code>{array} settings</code> <ul><li><code>{booleant} [flatOne = true]</code> - see an explanation below</li> <li><code>{booleant} [getFirst = false]</code> - see an explanation below</li></ul></li> <li><code>{array} parameters</code> - input parameters</li></ul></li></ul></li> <li><strong>Returns:</strong> <ul><li><code>{function}</code> - function that will change response output
<ul><li><strong>Arguments:</strong> <ul><li><code>{object | array} response</code> graphql response</li></ul></li> <li><strong>Returns:</strong> <ul><li><code>{object | array} response</code> response after manipulation</li></ul></li></ul></li></ul></li> <li><strong>Example</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> gqlResponse <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;teams&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token string">&quot;team_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">flatGqlResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    flatSettings<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token string">'teams.select'</span><span class="token operator">:</span> <span class="token string">'teams'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        flatOne<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        getFirst<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">/* 
1. data key is a default path, so no need to change it somehow, so base response is:
let gqlResponse = {
  teams: [
    {
      id: 7,
      team_name: &quot;test&quot;
    }
  ]
}

2. flatSettings - {'teams.select': 'teams'} will change path 'teams' to 'teams.select'
This is needed to make every request looks the same tableName.select, tableName.aggregate, tableName.insert etc...
let gqlResponse = {
  teams: {
    select: [
      {
        id: 7,
        team_name: &quot;test&quot;
      }
    ]
  }
}

3. flatOne is a tricky one. It also changes a path, deleting sinle object keys. 
In our example teams and select are both singe keys, so it will transform path 'teams.select' to ''
let gqlResponse = [
  {
    id: 7,
    team_name: &quot;test&quot;
  }
]

4. getFirst just return first entry of an array. Very useful if you want to get one user for example and you will get just user object
let gqlResponse = {
  id: 7,
  team_name: &quot;test&quot;
}
*/</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This methods used to generate query/mutation from parameters
This section could be useful if you want to generate queries by yourself, but I think they need to be refactored, so I'll skip documentation for now</p></div> <h3 id="this-buildquery-parameters-querytype"><a href="#this-buildquery-parameters-querytype" class="header-anchor">#</a> <code>this.buildQuery( parameters, queryType )</code></h3> <h3 id="this-buildmutation-parameters"><a href="#this-buildmutation-parameters" class="header-anchor">#</a> <code>this.buildMutation( parameters )</code></h3> <h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>Hasura<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'hasura-om'</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> orm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hasura</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    graphqlUrl<span class="token operator">:</span> <span class="token string">'url'</span><span class="token punctuation">,</span>
    adminSecret<span class="token operator">:</span> <span class="token string">'secret'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">generateTablesFromAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> user<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> _eq<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">/* 
    {
        id: 3,
        ...userFields
    }
*/</span>

<span class="token keyword">let</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> user<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> orm<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span> 
        where<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> _eq<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">/* 
    {
        id: 3,
        name: 'Peter'
    }
*/</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api/" class="prev router-link-active">
        Introduction
      </a></span> <span class="next"><a href="/api/table.html">
        Table
      </a>
      →
    </span></p></div>  <footer class="footer" data-v-0fa9bcfa>
	This framework is not affiliated with the Hasura team.
	<br data-v-0fa9bcfa><br data-v-0fa9bcfa>
	MIT Licensed | 2020-present
	<a href="https://github.com/mrspartak" target="_blank" rel="noopener noreferrer" data-v-0fa9bcfa>by Spartak</a></footer></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b0b3b14d.js" defer></script><script src="/assets/js/2.8f0b80ee.js" defer></script><script src="/assets/js/3.3e1d89ec.js" defer></script><script src="/assets/js/11.e6b53fb8.js" defer></script>
  </body>
</html>
